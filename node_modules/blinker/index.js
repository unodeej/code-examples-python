'use strict';

function makeBlinker(tessel) {

    function blink(count, duration) {
        var led = this.led,
            duration = duration || 100,
            times = [],
            i;

        for (i = 0; i < 2 * count; i += 1) {
            times[i] = duration * i;
        }

        times.map(function (t) {
            setTimeout(function () {
                led.toggle();
            }, t);
        });
    }

    function wrapLed(i) {
        return {
            led: tessel.led[i],
            on: function () {
                return this.led.output(1);
            },
            off: function () {
                return this.led.output(0);
            },
            blink: blink
        };
    }

    return {
        green:  wrapLed(0),
        blue:   wrapLed(1),
        red:    wrapLed(2),
        yellow: wrapLed(3)
    };
}

module.exports = {
    use: makeBlinker
};

